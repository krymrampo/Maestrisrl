<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="News e aggiornamenti Maestri Srl: novità prodotti, fiere, eventi e comunicazioni aziendali.">
    <title>News - Maestri Srl</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/components.css">
    <link rel="stylesheet" href="../css/responsive.css">
    <link rel="icon" type="image/png" href="../assets/images/favicon.png">
</head>
<body>
    <header class="header">
        <div class="container header-inner">
            <a href="../index.html" class="logo">
                <img src="../assets/images/logo.png" alt="Maestri Srl">
                <div class="logo-text">MAESTRI<span>OFFICINE MECCANICHE</span></div>
            </a>
            <nav class="nav">
                <ul class="nav-list">
                    <li><a href="../index.html" class="nav-link">Home</a></li>
                    <li class="dropdown">
                        <a href="prodotti.html" class="nav-link dropdown-toggle">Prodotti <i class="fas fa-chevron-down"></i></a>
                        <ul class="dropdown-menu">
                            <li><a href="grasso.html" class="dropdown-item"><i class="fas fa-oil-can"></i> Grasso</a></li>
                            <li><a href="gasolio.html" class="dropdown-item"><i class="fas fa-gas-pump"></i> Gasolio</a></li>
                            <li><a href="olio.html" class="dropdown-item"><i class="fas fa-droplet"></i> Olio</a></li>
                            <li><a href="urea.html" class="dropdown-item"><i class="fas fa-tint"></i> Urea/AdBlue</a></li>
                            <li><a href="antigelo.html" class="dropdown-item"><i class="fas fa-snowflake"></i> Antigelo</a></li>
                            <li><a href="acqua-lavavetri.html" class="dropdown-item"><i class="fas fa-water"></i> Acqua e Lavavetri</a></li>
                            <li><a href="accessori.html" class="dropdown-item"><i class="fas fa-cogs"></i> Accessori</a></li>
                        </ul>
                    </li>
                    <li><a href="chi-siamo.html" class="nav-link">Chi Siamo</a></li>
                    <li><a href="news.html" class="nav-link active">News</a></li>
                    <li><a href="contatti.html" class="nav-link">Contatti</a></li>
                </ul>
            </nav>
            <div class="header-actions">
                <a href="login.html" class="btn-icon auth-link" title="Area Riservata">
                    <i class="fas fa-lock"></i>
                    <span>Area Riservata</span>
                </a>
                <button class="menu-toggle" aria-label="Menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>

    <main class="main">
        <section class="page-header">
            <div class="container">
                <h1>News</h1>
                <p>Resta aggiornato sulle novità Maestri</p>
                <nav class="breadcrumb">
                    <a href="../index.html">Home</a><span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-current">News</span>
                </nav>
            </div>
        </section>

        <section class="section">
            <div class="container">
                <!-- Filter -->
                <div class="filter-chips mb-4" id="news-filters">
                    <button class="filter-chip active" data-filter="all">Tutte</button>
                    <button class="filter-chip" data-filter="Prodotti">Prodotti</button>
                    <button class="filter-chip" data-filter="Azienda">Azienda</button>
                    <button class="filter-chip" data-filter="Fiere">Fiere</button>
                    <button class="filter-chip" data-filter="Formazione">Formazione</button>
                </div>

                <!-- News Grid -->
                <div class="news-grid" id="news-grid">
                    <!-- Loaded by JS -->
                </div>

                <!-- Pagination -->
                <div class="pagination" id="pagination">
                    <a href="#" class="disabled"><i class="fas fa-chevron-left"></i></a>
                    <span class="current">1</span>
                    <a href="#">2</a>
                    <a href="#"><i class="fas fa-chevron-right"></i></a>
                </div>
            </div>
        </section>

        <!-- CTA -->
        <section class="cta">
            <div class="container">
                <h2>Resta Aggiornato</h2>
                <p>Iscriviti alla newsletter per ricevere le ultime novità direttamente nella tua email.</p>
                <form class="login-form" style="max-width: 500px; margin: 0 auto;">
                    <div class="form-group">
                        <input type="email" class="form-control" placeholder="La tua email" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Iscriviti</button>
                </form>
            </div>
        </section>
    </main>

    <!-- Article Modal -->
    <div class="modal-overlay" id="article-modal">
        <div class="modal modal-lg">
            <div class="modal-header">
                <h3 class="modal-title" id="article-title"></h3>
                <button class="modal-close" onclick="closeModal('article-modal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body" id="article-body"></div>
            <div class="modal-footer">
                <button class="btn btn-ghost" onclick="closeModal('article-modal')">Chiudi</button>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <img src="../assets/images/logo-white.png" alt="Maestri Srl">
                    <p>Officine meccaniche specializzate in sistemi di lubrificazione dal 1950.</p>
                </div>
                <div class="footer-nav">
                    <h4 class="footer-title">Navigazione</h4>
                    <ul class="footer-links">
                        <li><a href="../index.html">Home</a></li>
                        <li><a href="prodotti.html">Prodotti</a></li>
                        <li><a href="chi-siamo.html">Chi Siamo</a></li>
                        <li><a href="news.html">News</a></li>
                        <li><a href="contatti.html">Contatti</a></li>
                    </ul>
                </div>
                <div class="footer-nav">
                    <h4 class="footer-title">Categorie</h4>
                    <ul class="footer-links">
                        <li><a href="grasso.html">Grasso</a></li>
                        <li><a href="gasolio.html">Gasolio</a></li>
                        <li><a href="urea.html">Urea/AdBlue</a></li>
                        <li><a href="olio.html">Olio</a></li>
                    </ul>
                </div>
                <div class="footer-contact">
                    <h4 class="footer-title">Contatti</h4>
                    <ul class="footer-links">
                        <li><i class="fas fa-phone"></i> <a href="tel:+390521993741">0521 993741</a></li>
                        <li><i class="fas fa-envelope"></i> <a href="mailto:info@maestrisrl.com">info@maestrisrl.com</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p class="footer-copyright">© 2024 Maestri Srl - Tutti i diritti riservati</p>
            </div>
        </div>
    </footer>

    <a href="https://wa.me/393498393463" class="whatsapp-float" target="_blank"><i class="fab fa-whatsapp"></i></a>
    <a href="#" class="back-to-top"><i class="fas fa-chevron-up"></i></a>

    <script src="../data/news.inline.js"></script>
    <script src="../js/main.js"></script>
    <script src="../js/auth.js"></script>

    <script>
        let newsData = [];
        let currentFilter = 'all';

        document.addEventListener('DOMContentLoaded', async function() {
            try {
                let data = window.MAESTRI_NEWS_DATA;
                if (!data) {
                    const response = await fetch('../data/news.json');
                    data = await response.json();
                }
                newsData = data.news;
                renderNews();
            } catch (e) {
                console.error('Error loading news:', e);
            }

            // Filter buttons
            document.querySelectorAll('#news-filters .filter-chip').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('#news-filters .filter-chip').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentFilter = this.dataset.filter;
                    renderNews();
                });
            });
        });

        function renderNews() {
            const container = document.getElementById('news-grid');
            let filtered = currentFilter === 'all' ? newsData : newsData.filter(n => n.categoria === currentFilter);

            container.innerHTML = filtered.map(n => `
                <article class="news-card" onclick="openArticle('${n.id}')" style="cursor: pointer;">
                    <div class="news-image">
                        <img src="${window.resolveAssetPath ? window.resolveAssetPath(n.immagine) : n.immagine}" alt="${n.titolo}" loading="lazy">
                    </div>
                    <div class="news-content">
                        <div class="news-meta">
                            <span class="news-category">${n.categoria}</span>
                            <span><i class="far fa-calendar"></i> ${new Date(n.data).toLocaleDateString('it-IT')}</span>
                        </div>
                        <h3 class="news-title">${n.titolo}</h3>
                        <p class="news-excerpt">${n.sommario}</p>
                        <span class="card-link">Leggi tutto <i class="fas fa-arrow-right"></i></span>
                    </div>
                </article>
            `).join('');
        }

        function openArticle(id) {
            const article = newsData.find(n => n.id === id);
            if (!article) return;

            document.getElementById('article-title').textContent = article.titolo;
            document.getElementById('article-body').innerHTML = `
                <div class="news-meta mb-3">
                    <span class="badge badge-primary">${article.categoria}</span>
                    <span><i class="far fa-calendar"></i> ${new Date(article.data).toLocaleDateString('it-IT')}</span>
                </div>
                <img src="${window.resolveAssetPath ? window.resolveAssetPath(article.immagine) : article.immagine}" alt="${article.titolo}" style="width: 100%; border-radius: 8px; margin-bottom: 1.5rem;">
                <p style="font-size: 1.1rem; line-height: 1.8; color: var(--text);">${article.contenuto}</p>
                <div class="mt-3">
                    ${article.tag.map(t => `<span class="badge badge-secondary" style="margin-right: 0.5rem;">#${t}</span>`).join('')}
                </div>
            `;
            openModal('article-modal');
        }
    </script>
</body>
</html>
